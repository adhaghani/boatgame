import{n as V,r,j as F,c as W}from"./index-DoLx1IZi.js";function k(){const[i,d]=r.useState({x:0,y:0});return r.useEffect(()=>{const l=m=>{d({x:m.clientX,y:m.clientY})};return window.addEventListener("mousemove",l),()=>{window.removeEventListener("mousemove",l)}},[]),i}function q(i){i=i.replace("#",""),i.length===3&&(i=i.split("").map(x=>x+x).join(""));const d=parseInt(i,16),l=d>>16&255,m=d>>8&255,R=d&255;return[l,m,R]}const O=({className:i="",quantity:d=100,staticity:l=50,ease:m=50,size:R=.4,refresh:x=!1,color:Y="aaaaaa",vx:S=0,vy:T=0,...b})=>{const{gameState:I}=V();if((I?.visualMode||"visual")==="performance")return null;const f=r.useRef(null),g=r.useRef(null),s=r.useRef(null),v=r.useRef([]),M=k(),y=r.useRef({x:0,y:0}),n=r.useRef({w:0,h:0}),h=typeof window<"u"?window.devicePixelRatio:1,E=r.useRef(null),p=r.useRef(null);r.useEffect(()=>{f.current&&(s.current=f.current.getContext("2d")),P(),A();const t=()=>{p.current&&clearTimeout(p.current),p.current=setTimeout(()=>{P()},200)};return window.addEventListener("resize",t),()=>{E.current!=null&&window.cancelAnimationFrame(E.current),p.current&&clearTimeout(p.current),window.removeEventListener("resize",t)}},[Y]),r.useEffect(()=>{L()},[M.x,M.y]),r.useEffect(()=>{P()},[x]);const P=()=>{$(),B()},L=()=>{if(f.current){const t=f.current.getBoundingClientRect(),{w:e,h:a}=n.current,o=M.x-t.left-e/2,u=M.y-t.top-a/2;o<e/2&&o>-e/2&&u<a/2&&u>-a/2&&(y.current.x=o,y.current.y=u)}},$=()=>{if(g.current&&f.current&&s.current){n.current.w=g.current.offsetWidth,n.current.h=g.current.offsetHeight,f.current.width=n.current.w*h,f.current.height=n.current.h*h,f.current.style.width=`${n.current.w}px`,f.current.style.height=`${n.current.h}px`,s.current.scale(h,h),v.current=[];for(let t=0;t<d;t++){const e=C();z(e)}}},C=()=>{const t=Math.floor(Math.random()*n.current.w),e=Math.floor(Math.random()*n.current.h),a=0,o=0,u=Math.floor(Math.random()*2)+R,c=0,w=parseFloat((Math.random()*.6+.1).toFixed(1)),X=(Math.random()-.5)*.1,G=(Math.random()-.5)*.1,H=.1+Math.random()*4;return{x:t,y:e,translateX:a,translateY:o,size:u,alpha:c,targetAlpha:w,dx:X,dy:G,magnetism:H}},N=q(Y),z=(t,e=!1)=>{if(s.current){const{x:a,y:o,translateX:u,translateY:c,size:w,alpha:X}=t;s.current.translate(u,c),s.current.beginPath(),s.current.arc(a,o,w,0,2*Math.PI),s.current.fillStyle=`rgba(${N.join(", ")}, ${X})`,s.current.fill(),s.current.setTransform(h,0,0,h,0,0),e||v.current.push(t)}},j=()=>{s.current&&s.current.clearRect(0,0,n.current.w,n.current.h)},B=()=>{j();const t=d;for(let e=0;e<t;e++){const a=C();z(a)}},D=(t,e,a,o,u)=>{const c=(t-e)*(u-o)/(a-e)+o;return c>0?c:0},A=()=>{j(),v.current.forEach((t,e)=>{const o=[t.x+t.translateX-t.size,n.current.w-t.x-t.translateX-t.size,t.y+t.translateY-t.size,n.current.h-t.y-t.translateY-t.size].reduce((c,w)=>Math.min(c,w)),u=parseFloat(D(o,0,20,0,1).toFixed(2));if(u>1?(t.alpha+=.02,t.alpha>t.targetAlpha&&(t.alpha=t.targetAlpha)):t.alpha=t.targetAlpha*u,t.x+=t.dx+S,t.y+=t.dy+T,t.translateX+=(y.current.x/(l/t.magnetism)-t.translateX)/m,t.translateY+=(y.current.y/(l/t.magnetism)-t.translateY)/m,z(t,!0),t.x<-t.size||t.x>n.current.w+t.size||t.y<-t.size||t.y>n.current.h+t.size){v.current.splice(e,1);const c=C();z(c)}}),E.current=window.requestAnimationFrame(A)};return F.jsx("div",{className:W("pointer-events-none",i),ref:g,"aria-hidden":"true",...b,children:F.jsx("canvas",{ref:f,className:"size-full"})})};export{O as P};
